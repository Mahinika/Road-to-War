<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hero Sprite Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a2e;
            color: #fff;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .sprite-container {
            background: #0f3460;
            border: 2px solid #4169e1;
            border-radius: 8px;
            padding: 20px;
            margin: 20px;
            text-align: center;
            min-width: 300px;
        }
        .sprite-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #b4d0ff;
        }
        .sprite-description {
            font-size: 14px;
            color: #999;
            margin-bottom: 15px;
        }
        canvas {
            border: 2px solid #fff;
            background: #2c3e50;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
        }
        .comparison {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }
        .info-box {
            background: #16213e;
            border: 1px solid #4169e1;
            border-radius: 4px;
            padding: 15px;
            margin-top: 20px;
            max-width: 800px;
        }
        .info-box h3 {
            color: #b4d0ff;
            margin-top: 0;
        }
        .info-box ul {
            text-align: left;
        }
        .info-box li {
            margin: 8px 0;
        }
    </style>
</head>
<body>
    <h1>Hero Sprite Visualization</h1>
    
    <div class="comparison">
        <!-- Placeholder Sprite -->
        <div class="sprite-container">
            <div class="sprite-title">Placeholder Sprite</div>
            <div class="sprite-description">48×48px - Used when sprite generation fails</div>
            <canvas id="placeholder" width="48" height="48"></canvas>
        </div>

        <!-- Intended Hero Sprite (SpriteGenerator) -->
        <div class="sprite-container">
            <div class="sprite-title">Intended Hero Sprite</div>
            <div class="sprite-description">192×192px - Generated by SpriteGenerator</div>
            <canvas id="heroSprite" width="192" height="192"></canvas>
        </div>

        <!-- Runtime Hero Generator Sprite -->
        <div class="sprite-container">
            <div class="sprite-title">Runtime Hero Generator</div>
            <div class="sprite-description">192×192px - Chibi base hero (underwear only, no equipment)</div>
            <canvas id="runtimeSprite" width="192" height="192"></canvas>
        </div>
    </div>

    <div class="info-box">
        <h3>Sprite Details</h3>
        <ul>
            <li><strong>Placeholder:</strong> Blue square (#1f4b99) with white border and light blue X cross. Simple fallback when generation fails.</li>
            <li><strong>SpriteGenerator (hero-sprite):</strong> Detailed Paladin with layered rendering:
                <ul>
                    <li>Shadow layer</li>
                    <li>Base body (legs, torso)</li>
                    <li>Silver armor with highlights</li>
                    <li>Head with helmet (royal blue visor)</li>
                    <li>Sword weapon</li>
                    <li>Armor details and engravings</li>
                </ul>
            </li>
            <li><strong>RuntimeHeroGenerator:</strong> Dynamic A-pose chibi base character sprite (pixel-perfect):
                <ul>
                    <li>Dynamic A-pose with asymmetric positioning (left arm forward, right arm back)</li>
                    <li>Chibi proportions (headSize: 76, headY: 44, with head tilt)</li>
                    <li>5-level skin shading (base, dark1, dark2, light1, light2) for depth</li>
                    <li>Striated 4-pack abs with horizontal shadow bands</li>
                    <li>Round pectoral muscles (left bigger for pose)</li>
                    <li>Spiky dark brown hair (5 main spikes, left-heavy, with internal shadows)</li>
                    <li>Angry expression: furrowed V-shaped eyebrows, slanted almond eyes, stern mouth</li>
                    <li>Prominent ears (left more visible, right partial)</li>
                    <li>Flowing capelet on left shoulder (asymmetrical, with clasp)</li>
                    <li>Fur-trimmed boots (white with grey fur cuffs, detailed shading)</li>
                    <li>White underwear with cloth folds and waistband</li>
                    <li>1px black outlines on all body parts</li>
                    <li>Ground shadow with inner fade</li>
                    <li>No equipment (base character model for future equipment layering)</li>
                </ul>
            </li>
        </ul>
    </div>

    <script>
        // Draw Placeholder Sprite
        function drawPlaceholder() {
            const canvas = document.getElementById('placeholder');
            const ctx = canvas.getContext('2d');
            const width = 48;
            const height = 48;

            // Base block (blue)
            ctx.fillStyle = '#1f4b99';
            ctx.fillRect(0, 0, width, height);

            // Border (white)
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 2;
            ctx.strokeRect(1, 1, width - 2, height - 2);

            // Cross (light blue)
            ctx.strokeStyle = '#b4d0ff';
            ctx.lineWidth = 1;
            ctx.globalAlpha = 0.5;
            ctx.beginPath();
            ctx.moveTo(4, 4);
            ctx.lineTo(width - 4, height - 4);
            ctx.moveTo(width - 4, 4);
            ctx.lineTo(4, height - 4);
            ctx.stroke();
            ctx.globalAlpha = 1.0;
        }

        // Draw Intended Hero Sprite (SpriteGenerator style)
        function drawHeroSprite() {
            const canvas = document.getElementById('heroSprite');
            const ctx = canvas.getContext('2d');
            const width = 192;
            const height = 192;
            const centerX = width / 2;
            const centerY = height / 2;

            // Clear
            ctx.fillStyle = '#2c3e50';
            ctx.fillRect(0, 0, width, height);

            // Shadow
            ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
            ctx.beginPath();
            ctx.ellipse(centerX, centerY + height * 0.4, width * 0.25, height * 0.075, 0, 0, Math.PI * 2);
            ctx.fill();

            // Legs (dark blue-gray)
            ctx.fillStyle = '#1a2332';
            ctx.fillRect(centerX - width * 0.2, centerY + height * 0.25, width * 0.15, height * 0.25);
            ctx.fillRect(centerX + width * 0.05, centerY + height * 0.25, width * 0.15, height * 0.25);

            // Torso base
            ctx.fillStyle = '#2c3e50';
            ctx.fillRect(centerX - width * 0.25, centerY - height * 0.1, width * 0.5, height * 0.4);

            // Chest plate (silver)
            ctx.fillStyle = '#c0c0c0';
            ctx.fillRect(centerX - width * 0.22, centerY - height * 0.08, width * 0.44, height * 0.35);

            // Armor highlight
            ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
            ctx.fillRect(centerX - width * 0.18, centerY - height * 0.05, width * 0.25, height * 0.2);

            // Shoulder pads
            ctx.fillStyle = '#c0c0c0';
            ctx.fillRect(centerX - width * 0.35, centerY - height * 0.15, width * 0.2, height * 0.15);
            ctx.fillRect(centerX + width * 0.15, centerY - height * 0.15, width * 0.2, height * 0.15);

            // Head (skin color)
            ctx.fillStyle = '#ffdbac';
            ctx.beginPath();
            ctx.arc(centerX, centerY - height * 0.3, width * 0.18, 0, Math.PI * 2);
            ctx.fill();

            // Helmet
            ctx.fillStyle = '#c0c0c0';
            ctx.fillRect(centerX - width * 0.22, centerY - height * 0.4, width * 0.44, height * 0.2);

            // Helmet visor (royal blue)
            ctx.fillStyle = 'rgba(65, 105, 225, 0.6)';
            ctx.fillRect(centerX - width * 0.15, centerY - height * 0.35, width * 0.3, height * 0.12);

            // Sword blade
            ctx.fillStyle = '#e0e0e0';
            ctx.fillRect(centerX + width * 0.25, centerY - height * 0.2, width * 0.08, height * 0.4);

            // Sword highlight
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            ctx.fillRect(centerX + width * 0.26, centerY - height * 0.18, width * 0.03, height * 0.35);

            // Sword guard
            ctx.fillStyle = '#8b4513';
            ctx.fillRect(centerX + width * 0.2, centerY + height * 0.05, width * 0.2, height * 0.08);
        }

        // Draw Runtime Hero Generator Sprite (Dynamic A-Pose, Pixel-Perfect)
        function drawRuntimeSprite() {
            const canvas = document.getElementById('runtimeSprite');
            const ctx = canvas.getContext('2d');
            const width = 192;
            const height = 192;

            // Clear
            ctx.fillStyle = 'transparent';
            ctx.clearRect(0, 0, width, height);

            // Dynamic A-pose proportions (from generator)
            const torsoY = 112;
            const torsoHeight = 38;
            const torsoBottom = torsoY + torsoHeight / 2; // 131
            const bootHeight = 20;
            const leftLegLen = 40;
            const rightLegLen = 36;
            
            const props = {
                centerX: 96,
                headSize: 76,
                headY: 44,
                headTiltX: -4,
                torsoWidth: 52,
                torsoHeight: torsoHeight,
                torsoY: torsoY,
                shoulderY: 80,
                leftShoulderX: 70,
                rightShoulderX: 122,
                // Legs: positioned to connect to torso bottom
                leftLegX: 76, 
                leftLegTop: torsoBottom + 10, // Leg starts just below torso/underwear area (141)
                leftLegLen: leftLegLen, 
                leftLegWidth: 24,
                leftLegY: torsoBottom + 10 + leftLegLen + bootHeight, // Boot bottom (181)
                rightLegX: 104, 
                rightLegTop: torsoBottom + 12, // Slightly lower for asymmetry (143)
                rightLegLen: rightLegLen, 
                rightLegWidth: 22,
                rightLegY: torsoBottom + 12 + rightLegLen + bootHeight, // Boot bottom (179)
                bootHeight: bootHeight, 
                furHeight: 6,
                leftArmUpperX: 62, leftArmUpperY: 82, leftArmUpperLen: 24, leftArmUpperW: 22,
                leftArmForeX: 74, leftArmForeY: 100, leftArmForeLen: 20, leftArmForeW: 18,
                rightArmUpperX: 114, rightArmUpperY: 84, rightArmUpperLen: 28, rightArmUpperW: 20,
                rightArmForeX: 128, rightArmForeY: 104, rightArmForeLen: 24, rightArmForeW: 16
            };

            // Precise palette (from generator)
            const palette = {
                skin: { 
                    base: '#E3B590', dark1: '#D4A37D', dark2: '#C6946F', 
                    light1: '#F0D1B2', light2: '#FFEDD7'
                },
                hair: { 
                    base: '#9C5F3A', dark1: '#7D4C2E', dark2: '#5F3A20', light: '#B8855A' 
                },
                eyes: { base: '#0A0A0A', highlight: '#FFFFFF' },
                eyebrows: { base: '#3A2F24', dark: '#261C14' },
                mouth: { base: '#3A2F24' },
                underwear: { base: '#FEFEFE', shadow1: '#F0F0F0', shadow2: '#E0E0E0' },
                boot: { base: '#FAFAFA', shadow: '#E8E8E8', highlight: '#FFFFFF' },
                fur: { base: '#5A5A5A', dark: '#404040', light: '#707070' },
                capelet: { base: '#3D4852', shadow: '#2A343E', highlight: '#5A6878' },
                clasp: { base: '#F4C430', shadow: '#DAA520', highlight: '#FFED6F', center: '#B8860B' }
            };

            // Helper: pixel perfect
            function pixelPerfect(x, y) {
                return { x: Math.floor(x + 0.5), y: Math.floor(y + 0.5) };
            }

            // Helper: draw outline
            function drawOutline(x, y, w, h, thick = 1) {
                const {x: px, y: py} = pixelPerfect(x, y);
                const pw = Math.floor(w), ph = Math.floor(h);
                ctx.fillStyle = '#000000';
                ctx.fillRect(px, py, pw, thick);
                ctx.fillRect(px, py + ph - thick, pw, thick);
                ctx.fillRect(px, py + thick, thick, ph - 2 * thick);
                ctx.fillRect(px + pw - thick, py + thick, thick, ph - 2 * thick);
            }

            // Draw shadow first
            const shadowY = 182;
            const shadowX = props.centerX - 4;
            ctx.fillStyle = 'rgba(0, 0, 0, 0.25)';
            ctx.beginPath();
            ctx.ellipse(shadowX, shadowY, 56, 16, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = 'rgba(0, 0, 0, 0.125)';
            ctx.beginPath();
            ctx.ellipse(shadowX + 8, shadowY - 2, 40, 10, 0, 0, Math.PI * 2);
            ctx.fill();

            // Draw capelet (behind character)
            const sx = props.leftShoulderX, sy = props.shoulderY;
            ctx.fillStyle = palette.capelet.base;
            ctx.beginPath();
            ctx.moveTo(sx - 2, sy - 2);
            ctx.lineTo(sx - 16, sy + 24);
            ctx.lineTo(sx + 10, sy + 28);
            ctx.closePath();
            ctx.fill();
            ctx.beginPath();
            ctx.moveTo(sx + 10, sy + 28);
            ctx.lineTo(sx + 18, sy + 12);
            ctx.lineTo(sx + 4, sy + 16);
            ctx.closePath();
            ctx.fill();
            // Flowing edge shadow
            ctx.fillStyle = palette.capelet.shadow;
            ctx.beginPath();
            ctx.moveTo(sx - 4, sy + 4);
            ctx.lineTo(sx - 14, sy + 28);
            ctx.lineTo(sx + 6, sy + 32);
            ctx.closePath();
            ctx.fill();
            // Top highlight
            ctx.fillStyle = palette.capelet.highlight;
            ctx.beginPath();
            ctx.moveTo(sx, sy - 2);
            ctx.lineTo(sx - 6, sy + 4);
            ctx.lineTo(sx + 4, sy);
            ctx.closePath();
            ctx.fill();

            // Draw legs skin (boot covers lower)
            function drawLegSkinPart(lx, topY, llen, lwidth, isLeft) {
                // topY is the top of leg skin, draw downward
                const cx = lx;
                const px = cx - lwidth / 2;
                const py = topY;
                const pw = lwidth;
                const ph = llen;
                ctx.fillStyle = palette.skin.base;
                ctx.fillRect(px, py, pw, ph);
                // Muscle bulge (calf) - positioned in middle-upper area
                const bulgeY = py + ph / 2 - 4;
                ctx.fillStyle = palette.skin.dark1;
                ctx.beginPath();
                ctx.ellipse(cx + (isLeft ? 2 : -2), bulgeY, 12, 8, 0, 0, Math.PI * 2);
                ctx.fill();
                // Inner shadow (right side for left leg, left side for right leg)
                ctx.fillStyle = palette.skin.dark2;
                const legShadowX = isLeft ? px + pw - 6 : px;
                ctx.fillRect(legShadowX, py + ph / 2, 6, ph / 2 - 4);
                // Top highlight
                ctx.fillStyle = palette.skin.light1;
                ctx.fillRect(px, py + 2, pw / 2, 8);
                // Outline
                drawOutline(px, py, pw, ph);
            }
            const leftLegSkinLen = props.leftLegLen - props.bootHeight;
            drawLegSkinPart(props.leftLegX, props.leftLegTop, leftLegSkinLen, props.leftLegWidth, true);
            const rightLegSkinLen = props.rightLegLen - props.bootHeight;
            drawLegSkinPart(props.rightLegX, props.rightLegTop, rightLegSkinLen, props.rightLegWidth, false);

            // Draw boots with fur trim
            function drawBoot(bx, by, bwidth, furH, bootH, isLeft) {
                const bootTopY = by - bootH;
                // Fur cuff
                ctx.fillStyle = palette.fur.base;
                ctx.beginPath();
                ctx.ellipse(bx, bootTopY, bwidth + 4, furH * 1.5, 0, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = palette.fur.dark;
                ctx.beginPath();
                ctx.ellipse(bx + (isLeft ? 2 : -2), bootTopY + 2, bwidth, furH, 0, 0, Math.PI * 2);
                ctx.fill();
                // Boot body
                ctx.fillStyle = palette.boot.base;
                const bootW = bwidth - 2;
                ctx.fillRect(bx - bootW / 2, bootTopY, bootW, bootH);
                // Boot shadows (right side for left boot, left side for right boot)
                ctx.fillStyle = palette.boot.shadow;
                const bootShadowX = isLeft ? bx - bootW / 2 + bootW / 2 : bx - bootW / 2;
                ctx.fillRect(bootShadowX, bootTopY + 4, bootW / 2, bootH - 6);
                // Top highlight
                ctx.fillStyle = palette.boot.highlight;
                ctx.fillRect(bx - bootW / 2, bootTopY, bootW / 2, 4);
                // Foot sole hint
                ctx.fillStyle = palette.boot.shadow;
                ctx.fillRect(bx - bootW / 2 - 2, by + 2, bootW + 4, 3);
                // Outline
                drawOutline(bx - bootW / 2 - 1, bootTopY, bootW + 2, bootH + 3);
            }
            drawBoot(props.leftLegX, props.leftLegY, props.leftLegWidth, props.furHeight, props.bootHeight, true);
            drawBoot(props.rightLegX, props.rightLegY, props.rightLegWidth, props.furHeight, props.bootHeight, false);

            // Draw body (torso with striated abs)
            const {centerX: cx, torsoY: ty, torsoWidth: tw, torsoHeight: th} = props;
            const x = cx - tw / 2, y = ty - th / 2;
            ctx.fillStyle = palette.skin.base;
            ctx.fillRect(x, y, tw, th);
            // Pecs (round, left bigger for pose)
            ctx.fillStyle = palette.skin.dark1;
            ctx.beginPath();
            ctx.arc(x + 10, ty - 6, 13, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(x + tw - 14, ty - 4, 11, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = palette.skin.dark2;
            ctx.beginPath();
            ctx.arc(x + 12, ty, 9, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(x + tw - 16, ty + 2, 7, 0, Math.PI * 2);
            ctx.fill();
            // Abs (4-pack striations)
            ctx.fillStyle = palette.skin.dark1;
            for (let i = 0; i < 4; i++) {
                ctx.fillRect(x + 6, ty + 2 + i * 6, tw - 12, 3);
            }
            // Directional highlights (top-left light)
            ctx.fillStyle = palette.skin.light2;
            ctx.fillRect(x + 2, y + 2, 16, 10);
            ctx.fillStyle = palette.skin.light1;
            ctx.fillRect(x + 8, y + 12, tw - 16, 8);
            // Side shadows
            ctx.fillStyle = palette.skin.dark2;
            ctx.fillRect(x + tw - 4, y + 8, 3, th - 12);
            ctx.fillRect(x, y + th / 2, 3, th / 2);
            // Outline
            drawOutline(x, y, tw, th);

            // Draw arms (dynamic A-pose)
            function drawArmPart(ax, ay, alen, awidth, isUpper, isLeft) {
                ctx.fillStyle = palette.skin.base;
                ctx.fillRect(ax - awidth / 2, ay, awidth, alen);
                // Bicep/tricep bulge (upper only)
                if (isUpper) {
                    ctx.fillStyle = palette.skin.dark1;
                    ctx.beginPath();
                    ctx.ellipse(ax + (isLeft ? 4 : -4), ay + 8, 12, 10, 0, 0, Math.PI * 2);
                    ctx.fill();
                }
                // Inner shadow (right side for left arm, left side for right arm)
                ctx.fillStyle = palette.skin.dark2;
                const shadowX = isLeft ? ax + awidth / 2 - 6 : ax - awidth / 2;
                ctx.fillRect(shadowX, ay + 4, 6, alen - 8);
                // Highlight
                ctx.fillStyle = palette.skin.light1;
                ctx.fillRect(ax - awidth / 2, ay + 2, awidth / 2 + 1, 10);
                // Fist/end shadow
                ctx.fillStyle = palette.skin.dark2;
                ctx.fillRect(ax - awidth / 2 + 2, ay + alen - 6, awidth - 4, 5);
                // Outline
                drawOutline(ax - awidth / 2, ay, awidth, alen);
            }
            // Left arm (forward flexed)
            drawArmPart(props.leftArmUpperX, props.leftArmUpperY, props.leftArmUpperLen, props.leftArmUpperW, true, true);
            drawArmPart(props.leftArmForeX, props.leftArmForeY, props.leftArmForeLen, props.leftArmForeW, false, true);
            // Right arm (back flexed)
            drawArmPart(props.rightArmUpperX, props.rightArmUpperY, props.rightArmUpperLen, props.rightArmUpperW, true, false);
            drawArmPart(props.rightArmForeX, props.rightArmForeY, props.rightArmForeLen, props.rightArmForeW, false, false);

            // Draw head (with tilt)
            const headCx = props.centerX + props.headTiltX;
            const headCy = props.headY;
            const headR = props.headSize / 2;
            ctx.fillStyle = palette.skin.base;
            ctx.beginPath();
            ctx.arc(headCx, headCy, headR, 0, Math.PI * 2);
            ctx.fill();
            // Cheek shadows
            ctx.fillStyle = palette.skin.dark1;
            ctx.beginPath();
            ctx.ellipse(headCx + 12, headCy + 4, 12, 10, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = palette.skin.dark2;
            ctx.beginPath();
            ctx.ellipse(headCx + 16, headCy + 8, 8, 6, 0, 0, Math.PI * 2);
            ctx.fill();
            // Forehead/nose highlight
            ctx.fillStyle = palette.skin.light2;
            ctx.fillRect(headCx - 10, headCy - headR + 8, 20, 8);
            // Jaw shadow
            ctx.fillStyle = palette.skin.dark1;
            ctx.beginPath();
            ctx.ellipse(headCx + 8, headCy + headR - 8, 10, 12, 0, 0, Math.PI * 2);
            ctx.fill();
            // Head outline
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.arc(headCx, headCy, headR, 0, Math.PI * 2);
            ctx.stroke();
            
            // Draw ears
            ctx.fillStyle = palette.skin.base;
            ctx.beginPath();
            ctx.ellipse(headCx - headR + 2, headCy - 2, 10, 14, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = palette.skin.dark1;
            ctx.beginPath();
            ctx.ellipse(headCx - headR + 6, headCy + 2, 5, 8, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = palette.skin.base;
            ctx.beginPath();
            ctx.ellipse(headCx + headR - 6, headCy + 2, 8, 12, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = palette.skin.dark1;
            ctx.beginPath();
            ctx.ellipse(headCx + headR - 4, headCy + 4, 4, 6, 0, 0, Math.PI * 2);
            ctx.fill();

            // Draw hair (spiky, left-heavy)
            ctx.fillStyle = palette.hair.base;
            ctx.beginPath();
            ctx.ellipse(headCx, headCy - 8, headR + 6, headR, 0, 0, Math.PI * 2);
            ctx.fill();
            // Spikes (5 main, left-heavy)
            ctx.beginPath();
            ctx.moveTo(headCx - 2, headCy - headR - 4);
            ctx.lineTo(headCx + 6, headCy - headR - 20);
            ctx.lineTo(headCx + 14, headCy - headR - 8);
            ctx.closePath();
            ctx.fill();
            ctx.beginPath();
            ctx.moveTo(headCx - 18, headCy - headR + 2);
            ctx.lineTo(headCx - 8, headCy - headR - 18);
            ctx.lineTo(headCx - 2, headCy - headR - 4);
            ctx.closePath();
            ctx.fill();
            ctx.beginPath();
            ctx.moveTo(headCx - headR - 2, headCy - 8);
            ctx.lineTo(headCx - headR + 8, headCy + 4);
            ctx.lineTo(headCx - 12, headCy - 16);
            ctx.closePath();
            ctx.fill();
            ctx.beginPath();
            ctx.moveTo(headCx + 10, headCy - headR - 2);
            ctx.lineTo(headCx + 20, headCy - headR - 12);
            ctx.lineTo(headCx + 16, headCy - headR + 4);
            ctx.closePath();
            ctx.fill();
            ctx.fillRect(headCx + headR - 4, headCy - 6, 10, 18);
            // Hair internal shadows
            ctx.fillStyle = palette.hair.dark1;
            ctx.fillRect(headCx - 6, headCy - headR + 4, 18, 8);
            ctx.beginPath();
            ctx.moveTo(headCx - 14, headCy - headR + 2);
            ctx.lineTo(headCx - 4, headCy - headR - 8);
            ctx.lineTo(headCx, headCy - headR - 2);
            ctx.closePath();
            ctx.fill();
            ctx.fillStyle = palette.hair.dark2;
            ctx.beginPath();
            ctx.moveTo(headCx - 12, headCy - headR - 10);
            ctx.lineTo(headCx - 2, headCy - headR);
            ctx.lineTo(headCx + 2, headCy - headR - 2);
            ctx.closePath();
            ctx.fill();
            // Highlights
            ctx.fillStyle = palette.hair.light;
            ctx.fillRect(headCx - 8, headCy - headR - 12, 16, 6);
            ctx.beginPath();
            ctx.moveTo(headCx - 16, headCy - headR + 4);
            ctx.lineTo(headCx - 6, headCy - headR - 6);
            ctx.lineTo(headCx - 2, headCy - headR);
            ctx.closePath();
            ctx.fill();
            // Hair outlines
            ctx.fillStyle = '#000000';
            ctx.fillRect(headCx - 20, headCy - headR - 16, 4, 2);
            ctx.fillRect(headCx + 18, headCy - headR - 10, 2, 2);

            // Draw face (angry expression)
            const eyeY = props.headY + 14;
            // Furrowed eyebrows (V angry)
            ctx.fillStyle = palette.eyebrows.base;
            ctx.beginPath();
            ctx.moveTo(headCx - 22, eyeY - 8);
            ctx.lineTo(headCx - 8, eyeY - 12);
            ctx.lineTo(headCx - 12, eyeY - 2);
            ctx.closePath();
            ctx.fill();
            ctx.beginPath();
            ctx.moveTo(headCx + 4, eyeY - 10);
            ctx.lineTo(headCx + 18, eyeY - 6);
            ctx.lineTo(headCx + 12, eyeY + 2);
            ctx.closePath();
            ctx.fill();
            ctx.fillStyle = palette.eyebrows.dark;
            ctx.fillRect(headCx - 16, eyeY - 6, 10, 2);
            ctx.fillRect(headCx + 6, eyeY - 8, 10, 2);
            // Slanted almond eyes (black)
            ctx.fillStyle = palette.eyes.base;
            ctx.beginPath();
            ctx.ellipse(headCx - 18, eyeY + 2, 14, 9, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.ellipse(headCx + 6, eyeY + 4, 13, 10, 0, 0, Math.PI * 2);
            ctx.fill();
            // Eye gleams (top-left)
            ctx.fillStyle = palette.eyes.highlight;
            ctx.fillRect(headCx - 14, eyeY + 1, 3, 3);
            ctx.fillRect(headCx + 10, eyeY + 3, 3, 3);
            // Stern mouth (grit)
            ctx.fillStyle = palette.mouth.base;
            ctx.fillRect(headCx - 5, props.headY + 28, 10, 2);
            ctx.fillStyle = palette.skin.dark2;
            ctx.fillRect(headCx - 3, props.headY + 26, 6, 1);

            // Draw underwear - positioned at torso bottom, overlapping slightly with legs
            const torsoBottom = ty + th / 2; // 131
            const uy = torsoBottom - 8;
            ctx.fillStyle = palette.underwear.base;
            ctx.fillRect(cx - 20, uy, 40, 20);
            // Cloth folds/shadows
            ctx.fillStyle = palette.underwear.shadow1;
            ctx.fillRect(cx - 18, uy + 6, 36, 12);
            ctx.fillStyle = palette.underwear.shadow2;
            ctx.fillRect(cx + 2, uy + 10, 16, 6);
            // Waistband highlight
            ctx.fillStyle = palette.underwear.base;
            ctx.fillRect(cx - 22, uy, 44, 4);
            // Outline
            drawOutline(cx - 22, uy, 44, 20);

            // Draw clasp
            ctx.fillStyle = palette.clasp.base;
            ctx.beginPath();
            ctx.arc(sx, sy, 7, 0, Math.PI * 2);
            ctx.fill();
            // Highlight
            ctx.fillStyle = palette.clasp.highlight;
            ctx.fillRect(sx - 4, sy - 4, 6, 4);
            // Shadow
            ctx.fillStyle = palette.clasp.shadow;
            ctx.fillRect(sx + 1, sy + 1, 5, 4);
            // Center gem
            ctx.fillStyle = palette.clasp.center;
            ctx.beginPath();
            ctx.arc(sx + 1, sy + 1, 3, 0, Math.PI * 2);
            ctx.fill();
            // Outline
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.arc(sx, sy, 7, 0, Math.PI * 2);
            ctx.stroke();
        }

        // Draw all sprites
        drawPlaceholder();
        drawHeroSprite();
        drawRuntimeSprite();
    </script>
</body>
</html>
