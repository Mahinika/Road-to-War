<!DOCTYPE html>
<html>
<head>
    <title>Animation Architecture Diagram</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: white;
        }
        .diagram {
            max-width: 1200px;
            margin: 0 auto;
        }
        .component {
            border: 2px solid #333;
            border-radius: 8px;
            padding: 15px;
            margin: 10px;
            text-align: center;
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .asset-generator { background: linear-gradient(135deg, #e8f5e8, #c8e6c9); }
        .animation-generator { background: linear-gradient(135deg, #fff9c4, #fff59d); }
        .runtime-generator { background: linear-gradient(135deg, #e0f7fa, #b2ebf2); }
        .animation-manager { background: linear-gradient(135deg, #fce4ec, #f8bbd9); }
        .phaser-system { background: linear-gradient(135deg, #ffecb3, #ffe082); }
        .utility { background: linear-gradient(135deg, #f5f5f5, #e0e0e0); }

        .flow-arrow {
            text-align: center;
            margin: 20px 0;
            font-size: 24px;
            color: #666;
        }

        .section {
            border: 2px solid #999;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            background: #f9f9f9;
        }

        .section-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            border-bottom: 2px solid #666;
            padding-bottom: 5px;
        }

        .components-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }

        .legend-item {
            padding: 10px;
            border-radius: 6px;
            font-size: 14px;
            text-align: center;
        }

        .memory-saving { background: linear-gradient(135deg, #4caf50, #2e7d32); color: white; }
        .runtime-gen { background: linear-gradient(135deg, #2196f3, #1565c0); color: white; }
        .joint-transforms { background: linear-gradient(135deg, #f44336, #c62828); color: white; }

        .arrow {
            font-size: 30px;
            color: #2196f3;
            margin: 10px;
        }

        .data-flow {
            border-left: 4px solid #2196f3;
            padding-left: 15px;
            margin: 15px 0;
            background: #e3f2fd;
            padding: 10px 15px;
            border-radius: 0 8px 8px 0;
        }

        .key-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .feature-box {
            border: 2px solid #4caf50;
            border-radius: 8px;
            padding: 15px;
            background: linear-gradient(135deg, #e8f5e8, #f1f8e9);
        }

        .feature-title {
            font-weight: bold;
            color: #2e7d32;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="diagram">
        <h1 style="text-align: center; color: #333; border-bottom: 3px solid #2196f3; padding-bottom: 10px;">
            Animation Architecture - Road of War
        </h1>

        <div class="section">
            <div class="section-title">ðŸŽ¯ Core Animation Pipeline</div>

            <div class="components-grid">
                <div class="component asset-generator">
                    <h3>AssetGenerator</h3>
                    <p>Coordinates animation creation<br>
                    Calls generateAnimations()</p>
                </div>

                <div class="arrow">â†’</div>

                <div class="component animation-generator">
                    <h3>AnimationGenerator</h3>
                    <p>Creates animation frames<br>
                    Manages keyframes & timing</p>
                </div>

                <div class="arrow">â†’</div>

                <div class="component runtime-generator">
                    <h3>RuntimePaladinGenerator</h3>
                    <p>Generates pixel-perfect sprites<br>
                    Handles joint transforms</p>
                </div>

                <div class="arrow">â†’</div>

                <div class="component animation-manager">
                    <h3>AnimationManager</h3>
                    <p>Manages animation lifecycle<br>
                    Shared pooling system</p>
                </div>

                <div class="arrow">â†’</div>

                <div class="component phaser-system">
                    <h3>Phaser Animation System</h3>
                    <p>Final animation playback<br>
                    Hardware-accelerated rendering</p>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">ðŸ”§ Key Technologies</div>

            <div class="components-grid">
                <div class="component utility">
                    <h3>JointTransform</h3>
                    <p>Mathematical calculations<br>
                    Knee/ankle positioning<br>
                    Rotation transforms</p>
                </div>

                <div class="component utility">
                    <h3>RenderTexture</h3>
                    <p>Off-screen rendering<br>
                    Frame composition<br>
                    GPU texture saving</p>
                </div>

                <div class="component utility">
                    <h3>Phaser Graphics</h3>
                    <p>Vector drawing<br>
                    Pixel-perfect rendering<br>
                    Texture generation</p>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">ðŸŽ­ Animation Types</div>

            <div class="key-features">
                <div class="feature-box">
                    <div class="feature-title">Idle Animation</div>
                    <p>â€¢ Subtle breathing motion<br>
                    â€¢ Sine wave Y-offset<br>
                    â€¢ 12 frames for smoothness</p>
                </div>

                <div class="feature-box">
                    <div class="feature-title">Walk Cycle</div>
                    <p>â€¢ Leg bending with knee joints<br>
                    â€¢ Opposite arm swing<br>
                    â€¢ Pelvis counter-rotation<br>
                    â€¢ 16 frames for realism</p>
                </div>

                <div class="feature-box">
                    <div class="feature-title">Attack Animation</div>
                    <p>â€¢ Forward momentum<br>
                    â€¢ Wind-up â†’ Strike â†’ Recovery<br>
                    â€¢ 12 frames with phases</p>
                </div>

                <div class="feature-box">
                    <div class="feature-title">Defend Animation</div>
                    <p>â€¢ Backward lean<br>
                    â€¢ Shield positioning<br>
                    â€¢ Subtle shield movement</p>
                </div>

                <div class="feature-box">
                    <div class="feature-title">Death Animation</div>
                    <p>â€¢ Dramatic fall<br>
                    â€¢ Rotation and scaling<br>
                    â€¢ Fade-out effect</p>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">âš¡ Performance Optimizations</div>

            <div class="key-features">
                <div class="feature-box">
                    <div class="feature-title">Shared Animation Pool</div>
                    <p>â€¢ One animation per character type<br>
                    â€¢ All paladins share same animations<br>
                    â€¢ 80-90% memory reduction</p>
                </div>

                <div class="feature-box">
                    <div class="feature-title">Runtime Generation</div>
                    <p>â€¢ Procedural sprite creation<br>
                    â€¢ No pre-rendered assets needed<br>
                    â€¢ Dynamic body part assembly</p>
                </div>

                <div class="feature-box">
                    <div class="feature-title">Lazy Loading</div>
                    <p>â€¢ Animations loaded on demand<br>
                    â€¢ Background preloading<br>
                    â€¢ Memory cleanup of unused assets</p>
                </div>

                <div class="feature-box">
                    <div class="feature-title">Frame Caching</div>
                    <p>â€¢ Generated frames cached<br>
                    â€¢ Reuse across animations<br>
                    â€¢ Texture validation system</p>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">ðŸ”„ Data Flow</div>

            <div class="data-flow">
                <strong>1. Animation Request:</strong> AnimationManager.initializeAnimations() â†’ AssetGenerator.generateAnimations()
            </div>

            <div class="data-flow">
                <strong>2. Frame Generation:</strong> AnimationGenerator â†’ RuntimePaladinGenerator.generateAnimationFrames() â†’ JointTransform calculations
            </div>

            <div class="data-flow">
                <strong>3. Rendering:</strong> Phaser Graphics â†’ RenderTexture.draw() â†’ texture.saveTexture() â†’ Animation frames array
            </div>

            <div class="data-flow">
                <strong>4. Registration:</strong> AnimationManager â†’ scene.anims.create() â†’ Shared animation pool
            </div>

            <div class="data-flow">
                <strong>5. Playback:</strong> Sprite.play() â†’ Phaser animation system â†’ GPU rendering
            </div>
        </div>

        <div class="section">
            <div class="section-title">ðŸŽ¨ Rendering Pipeline</div>

            <div style="text-align: center; margin: 20px 0;">
                <div style="display: inline-block; background: #e8f5e8; padding: 15px; border-radius: 8px; border: 2px solid #4caf50;">
                    <strong>Pixel-Perfect Chibi Character</strong><br>
                    192Ã—192 base resolution â€¢ Joint-based transforms â€¢ 5-level shading
                </div>
            </div>

            <div class="flow-arrow">â†“</div>

            <div class="components-grid">
                <div class="component">
                    <h4>Component Transforms</h4>
                    <p>â€¢ Leg bending at knees<br>
                    â€¢ Arm swinging at shoulders<br>
                    â€¢ Foot positioning at ankles<br>
                    â€¢ Pelvis counter-rotation</p>
                </div>

                <div class="arrow">+</div>

                <div class="component">
                    <h4>Global Transforms</h4>
                    <p>â€¢ Whole body translation<br>
                    â€¢ Character rotation<br>
                    â€¢ Scale adjustments<br>
                    â€¢ Breathing effects</p>
                </div>

                <div class="arrow">=</div>

                <div class="component phaser-system">
                    <h4>Final Animation Frame</h4>
                    <p>â€¢ Composited sprite<br>
                    â€¢ RenderTexture output<br>
                    â€¢ GPU-ready texture<br>
                    â€¢ Cached for reuse</p>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">ðŸ“Š Legend</div>

            <div class="legend">
                <div class="legend-item memory-saving">
                    <strong>ðŸ§  Memory Saving</strong><br>
                    Shared animations reduce memory usage by 80-90%
                </div>

                <div class="legend-item runtime-gen">
                    <strong>âš¡ Runtime Generation</strong><br>
                    Procedural sprites created on-demand
                </div>

                <div class="legend-item joint-transforms">
                    <strong>ðŸ”„ Joint Transforms</strong><br>
                    Realistic limb movement with mathematical precision
                </div>
            </div>
        </div>

        <div style="text-align: center; margin: 30px 0; padding: 20px; background: #f0f8ff; border-radius: 12px; border: 2px solid #2196f3;">
            <h3 style="color: #1565c0; margin: 0;">ðŸš€ Key Innovation</h3>
            <p style="font-size: 16px; margin: 10px 0;">
                <strong>Runtime-Generated Animations with Joint Transforms</strong><br>
                No pre-rendered sprite sheets â€¢ Dynamic body part assembly â€¢ Mathematical limb positioning<br>
                <em>Every animation frame is procedurally generated with pixel-perfect precision</em>
            </p>
        </div>
    </div>
</body>
</html>
